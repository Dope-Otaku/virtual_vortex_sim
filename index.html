<!DOCTYPE html>
<html>
<head>
  <style>body{margin:0; background:black}</style>
</head>
<body>
<script src="https://cdn.jsdelivr.net/npm/three@0.152/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.152/examples/js/loaders/GLTFLoader.js"></script>

<script>
const scene = new THREE.Scene()
const camera = new THREE.PerspectiveCamera(75, innerWidth/innerHeight, 0.1, 1000)
const renderer = new THREE.WebGLRenderer({antialias:true})
renderer.setSize(innerWidth, innerHeight)
document.body.appendChild(renderer.domElement)

camera.position.z = 6

// Light
const light = new THREE.PointLight(0xffaa00, 2)
light.position.set(5,5,5)
scene.add(light)

// Load Ninja Model (your own anime-style glTF)
let ninja
new THREE.GLTFLoader().load("ninja.glb", g => {
  ninja = g.scene
  ninja.scale.set(1.5,1.5,1.5)
  scene.add(ninja)
})

// Fireball
const fire = new THREE.Mesh(
  new THREE.SphereGeometry(0.3,32,32),
  new THREE.MeshStandardMaterial({ emissive: 0xff4500, emissiveIntensity: 2 })
)
fire.visible = false
scene.add(fire)

// WebSocket
const socket = new WebSocket("ws://localhost:8765")
socket.onmessage = e => {
  const data = JSON.parse(e.data)
  if(data.event === "FIRE_JUTSU") throwFire()
}

function throwFire(){
  fire.visible = true
  fire.position.set(0,1,0)
  let z = 0
  const interval = setInterval(()=>{
    fire.position.z -= 0.2
    if(fire.position.z < -10){
      fire.visible = false
      clearInterval(interval)
    }
  },16)
}

function animate(){
  requestAnimationFrame(animate)
  if(ninja) ninja.rotation.y += 0.005
  renderer.render(scene,camera)
}
animate()
</script>
</body>
</html>